<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket.io</title>
</head>

<body>
    <h1 id="title">Socket.io</h1>

    <input onfocus="this.value=''" type="text" id="message" placeholder="Message">
    <button type="submit" id="btn" onclick="sendMessage()">Send</button>

    <ul id="messages"></ul>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"
        integrity="sha512-0qU9M9jfqPw6FKkPafM3gy2CBAvUWnYVOfNPDYKVuRTel1PrciTj+a9P3loJB+j0QmN2Y0JYQmkBBS8W+mbezg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.socket.io/4.5.3/socket.io.min.js"
        integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi"
        crossorigin="anonymous"></script>
    <script>
        const title = document.querySelector('#title');

        let id = ''

        const socket = io("http://localhost:3000/");
        socket.on("connect", () => {
            id = socket.io.engine.id
            title.innerHTML = `Socket.io ${id}`
        });
        socket.on('msg', (message) => {
            showMessage(message)
        });

        function showMessage(message) {
            var msgLi = document.querySelector('#messages');
            let element = document.createElement('li');
            element.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`
            element.style.listStyleType = 'none'
            msgLi.appendChild(element);
        }

        const mensageInput = document.querySelector('#message');

        function sendMessage() {
            axios.get(`http://localhost:3000/send/?message=${id}: ${mensageInput.value}`)
        }

    </script>
</body>

</html>